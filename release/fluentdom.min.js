var FluentDOM=function(a,b){if(window==this)return new FluentDOM(a,b);var c=function(a){this.result=a,this.items=[]};c.prototype.toArray=function(){var a=[];return this.each(function(){a.push(this)}),a},c.prototype.each=function(a){for(var b,c=0,d=0;d<this.items.length;d++)a.call(this.items[d],c++);if(this.result)for(;b=this.result.iterateNext();)this.items.push(b),a.call(b,c++);this.result=null};var d=function(a){var b;return b=a instanceof Function&&!a.lookupNamespaceURI instanceof Function?a:a&&a.lookupNamespaceURI instanceof Function?a.lookupNamespaceURI:function(a){return a=a instanceof Object?a:{},function(b){return""==b?null:a[b]||null}}(a),b.fromNodeName=function(a){var c;return c=a.indexOf(":")>-1?a.substr(0,a.indexOf(":"))||"":"#default",b(c)},b}(b),e=function(b,c){var f,g;if(c instanceof Node)c instanceof Document?c.documentElement&&b.appendChild(b.ownerDocument.importNode(c.documentElement,!0)):(c=b.ownerDocument!=c.ownerDocument?b.ownerDocument.importNode(c,!0):c.cloneNode(!0),c instanceof Attr?b.setAttributeNode(c):b.appendChild(c));else if(c instanceof Array){for(f=0;f<c.length;f++)e(b,c[f]);b.appendChild(a.createTextNode(c))}else if(c instanceof Object)for(f in c)c.hasOwnProperty(f)&&((g=d.fromNodeName(f))?b.setAttributeNS(d.fromNodeName(f),f,c[f]):b.setAttribute(f,c[f]));else"string"==typeof c&&b.appendChild(a.createTextNode(c.toString()))};this.create=function(b){var c,f;c=d.fromNodeName(b),f=c?a.createElementNS(c,b):a.createElement(b);for(var g=1;g<arguments.length;g++)e(f,arguments[g]);return f},this.create.cdata=function(b){return a.createCDATASection(b)},this.create.comment=function(b){return a.createComment(b)},this.create.pi=function(b){return a.createProcessingInstruction(b)},this.create.each=function(b,c){var d,f,g;if(c=c instanceof Function?c:function(a){return a},d=a.createDocumentFragment(),b instanceof Array)for(g=0;g<b.length;g++)f=c(b[g],g),f&&e(d,f);else if(b instanceof Object)for(g in b)b.hasOwnProperty(g)&&(f=c(b[g],g),f&&e(d,f));return d},this.document=function(b){var c;return c=a.documentElement?a.implementation.createDocument("","",null):a,c.appendChild(b),c.save=function(){return(new XMLSerializer).serializeToString(a)},c},this.evaluate=function(b,e,f){e=e instanceof Node?e:a,f=f||XPathResult.ANY_TYPE;var g=a.evaluate(b,e,{lookupNamespaceURI:d},f,null);switch(g.resultType){case XPathResult.BOOLEAN_TYPE:return g.booleanValue;case XPathResult.NUMBER_TYPE:return g.numberValue;case XPathResult.STRING_TYPE:return g.stringValue;case XPathResult.FIRST_ORDERED_NODE_TYPE:return g.singleNodeValue;default:return new c(g)}},a===!0?a=document.implementation.createDocument("","",null):a instanceof Document||(a=document),a&&!a.evaluate&&"undefined"!=typeof installDOM3XPathSupport&&installDOM3XPathSupport(a,new XPathParser)};