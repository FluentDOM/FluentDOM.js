"undefined"==typeof exports&&(xpath={}),function(a){function b(){this.init()}function c(a){this.expression=a}function d(){}function e(a){arguments.length>0&&this.init(a)}function f(a){arguments.length>0&&this.init(a)}function g(a,b){arguments.length>0&&this.init(a,b)}function h(a,b){arguments.length>0&&this.init(a,b)}function i(a,b){arguments.length>0&&this.init(a,b)}function j(a,b){arguments.length>0&&this.init(a,b)}function k(a,b){arguments.length>0&&this.init(a,b)}function l(a,b){arguments.length>0&&this.init(a,b)}function m(a,b){arguments.length>0&&this.init(a,b)}function n(a,b){arguments.length>0&&this.init(a,b)}function o(a,b){arguments.length>0&&this.init(a,b)}function p(a,b){arguments.length>0&&this.init(a,b)}function q(a,b){arguments.length>0&&this.init(a,b)}function r(a,b){arguments.length>0&&this.init(a,b)}function s(a,b){arguments.length>0&&this.init(a,b)}function t(a,b){arguments.length>0&&this.init(a,b)}function u(a,b){arguments.length>0&&this.init(a,b)}function v(a,b,c){arguments.length>0&&this.init(a,b,c)}function w(a,b){arguments.length>0&&this.init(a,b)}function x(a,b,c){arguments.length>0&&this.init(a,b,c)}function y(a,b){arguments.length>0&&this.init(a,b)}function z(a){arguments.length>0&&this.init(a)}function A(a,b){arguments.length>0&&this.init(a,b)}function B(a){arguments.length>0&&this.init(a)}function C(a){arguments.length>0&&this.init(a)}function D(a){arguments.length>0&&this.init(a)}function E(a){this.init(a)}function F(){this.init()}function G(a,b,c){this.isXPathNamespace=!0,this.ownerDocument=c.ownerDocument,this.nodeName="#namespace",this.prefix=a,this.localName=a,this.namespaceURI=b,this.nodeValue=b,this.ownerElement=c,this.nodeType=G.XPATH_NAMESPACE_NODE}function H(a,b,c){this.variableResolver=null!=a?a:new I,this.namespaceResolver=null!=b?b:new K,this.functionResolver=null!=c?c:new J}function I(){}function J(a){this.thisArg=null!=a?a:Functions,this.functions=new Object,this.addStandardFunctions()}function K(){}function L(a,b){this.code=a,this.exception=b}function M(a,b,c){this.xpath=c.parse(a),this.context=new H,this.context.namespaceResolver=new N(b)}function N(a){this.xpathNSResolver=a}function O(a){this.node=a,this.namespaceResolver=new K}function P(a,b){switch(b==P.ANY_TYPE&&(a.constructor===B?b=P.STRING_TYPE:a.constructor===C?b=P.NUMBER_TYPE:a.constructor===D?b=P.BOOLEAN_TYPE:a.constructor===F&&(b=P.UNORDERED_NODE_ITERATOR_TYPE)),this.resultType=b,b){case P.NUMBER_TYPE:return void(this.numberValue=a.numberValue());case P.STRING_TYPE:return void(this.stringValue=a.stringValue());case P.BOOLEAN_TYPE:return void(this.booleanValue=a.booleanValue());case P.ANY_UNORDERED_NODE_TYPE:case P.FIRST_ORDERED_NODE_TYPE:if(a.constructor===F)return void(this.singleNodeValue=a.first());break;case P.UNORDERED_NODE_ITERATOR_TYPE:case P.ORDERED_NODE_ITERATOR_TYPE:if(a.constructor===F)return this.invalidIteratorState=!1,this.nodes=a.toArray(),void(this.iteratorIndex=0);break;case P.UNORDERED_NODE_SNAPSHOT_TYPE:case P.ORDERED_NODE_SNAPSHOT_TYPE:if(a.constructor===F)return this.nodes=a.toArray(),void(this.snapshotLength=this.nodes.length)}throw new L(L.TYPE_ERR)}function Q(a,b){a.createExpression=function(a,c){try{return new M(a,c,b)}catch(a){throw new L(L.INVALID_EXPRESSION_ERR,a)}},a.createNSResolver=function(a){return new O(a)},a.evaluate=function(c,d,e,f,g){if(0>f||f>9)throw{code:0,toString:function(){return"Request type not supported"}};return a.createExpression(c,e,b).evaluate(d,f,g)}}b.prototype=new Object,b.prototype.constructor=b,b.superclass=Object.prototype,b.prototype.init=function(){this.reduceActions=[],this.reduceActions[3]=function(a){return new h(a[0],a[2])},this.reduceActions[5]=function(a){return new i(a[0],a[2])},this.reduceActions[7]=function(a){return new j(a[0],a[2])},this.reduceActions[8]=function(a){return new k(a[0],a[2])},this.reduceActions[10]=function(a){return new l(a[0],a[2])},this.reduceActions[11]=function(a){return new m(a[0],a[2])},this.reduceActions[12]=function(a){return new n(a[0],a[2])},this.reduceActions[13]=function(a){return new o(a[0],a[2])},this.reduceActions[15]=function(a){return new p(a[0],a[2])},this.reduceActions[16]=function(a){return new q(a[0],a[2])},this.reduceActions[18]=function(a){return new r(a[0],a[2])},this.reduceActions[19]=function(a){return new s(a[0],a[2])},this.reduceActions[20]=function(a){return new t(a[0],a[2])},this.reduceActions[22]=function(a){return new f(a[1])},this.reduceActions[24]=function(a){return new u(a[0],a[2])},this.reduceActions[25]=function(a){return new v(void 0,void 0,a[0])},this.reduceActions[27]=function(a){return a[0].locationPath=a[2],a[0]},this.reduceActions[28]=function(a){return a[0].locationPath=a[2],a[0].locationPath.steps.unshift(new x(x.DESCENDANTORSELF,new y(y.NODE,void 0),[])),a[0]},this.reduceActions[29]=function(a){return new v(a[0],[],void 0)},this.reduceActions[30]=function(a){return Utilities.instance_of(a[0],v)?(void 0==a[0].filterPredicates&&(a[0].filterPredicates=[]),a[0].filterPredicates.push(a[1]),a[0]):new v(a[0],[a[1]],void 0)},this.reduceActions[32]=function(a){return a[1]},this.reduceActions[33]=function(a){return new B(a[0])},this.reduceActions[34]=function(a){return new C(a[0])},this.reduceActions[36]=function(a){return new A(a[0],[])},this.reduceActions[37]=function(a){return new A(a[0],a[2])},this.reduceActions[38]=function(a){return[a[0]]},this.reduceActions[39]=function(a){return a[2].unshift(a[0]),a[2]},this.reduceActions[43]=function(){return new w(!0,[])},this.reduceActions[44]=function(a){return a[1].absolute=!0,a[1]},this.reduceActions[46]=function(a){return new w(!1,[a[0]])},this.reduceActions[47]=function(a){return a[0].steps.push(a[2]),a[0]},this.reduceActions[49]=function(a){return new x(a[0],a[1],[])},this.reduceActions[50]=function(a){return new x(x.CHILD,a[0],[])},this.reduceActions[51]=function(a){return new x(a[0],a[1],a[2])},this.reduceActions[52]=function(a){return new x(x.CHILD,a[0],a[1])},this.reduceActions[54]=function(a){return[a[0]]},this.reduceActions[55]=function(a){return a[1].unshift(a[0]),a[1]},this.reduceActions[56]=function(a){return"ancestor"==a[0]?x.ANCESTOR:"ancestor-or-self"==a[0]?x.ANCESTORORSELF:"attribute"==a[0]?x.ATTRIBUTE:"child"==a[0]?x.CHILD:"descendant"==a[0]?x.DESCENDANT:"descendant-or-self"==a[0]?x.DESCENDANTORSELF:"following"==a[0]?x.FOLLOWING:"following-sibling"==a[0]?x.FOLLOWINGSIBLING:"namespace"==a[0]?x.NAMESPACE:"parent"==a[0]?x.PARENT:"preceding"==a[0]?x.PRECEDING:"preceding-sibling"==a[0]?x.PRECEDINGSIBLING:"self"==a[0]?x.SELF:-1},this.reduceActions[57]=function(){return x.ATTRIBUTE},this.reduceActions[59]=function(a){return"comment"==a[0]?new y(y.COMMENT,void 0):"text"==a[0]?new y(y.TEXT,void 0):"processing-instruction"==a[0]?new y(y.PI,void 0):"node"==a[0]?new y(y.NODE,void 0):new y(-1,void 0)},this.reduceActions[60]=function(a){return new y(y.PI,a[2])},this.reduceActions[61]=function(a){return a[1]},this.reduceActions[63]=function(a){return a[1].absolute=!0,a[1].steps.unshift(new x(x.DESCENDANTORSELF,new y(y.NODE,void 0),[])),a[1]},this.reduceActions[64]=function(a){return a[0].steps.push(new x(x.DESCENDANTORSELF,new y(y.NODE,void 0),[])),a[0].steps.push(a[2]),a[0]},this.reduceActions[65]=function(){return new x(x.SELF,new y(y.NODE,void 0),[])},this.reduceActions[66]=function(){return new x(x.PARENT,new y(y.NODE,void 0),[])},this.reduceActions[67]=function(a){return new z(a[1])},this.reduceActions[68]=function(){return new y(y.NAMETESTANY,void 0)},this.reduceActions[69]=function(a){var b=a[0].substring(0,a[0].indexOf(":"));return new y(y.NAMETESTPREFIXANY,b)},this.reduceActions[70]=function(a){return new y(y.NAMETESTQNAME,a[0])}},b.actionTable=[" s s        sssssssss    s ss  s  ss","                 s                  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                rrrrr               "," s s        sssssssss    s ss  s  ss","rs  rrrrrrrr s  sssssrrrrrr  rrs rs "," s s        sssssssss    s ss  s  ss","                            s       ","                            s       ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","  s                                 ","                            s       "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr  r  ","a                                   ","r       s                    rr  r  ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrs  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  srrrrrrrr         rrrrrrs rr sr  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                sssss               ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  srrrrrrrr         rrrrrrs rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","              s                     ","                             s      ","                rrrrr               "," s s        sssssssss    s sss s  ss","r  srrrrrrrr         rrrrrrs rr  r  "," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss      ss  s  ss"," s s        sssssssss    s ss  s  ss"," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr rr  "," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             rr     ","                             s      ","                             rs     ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","                                 r  ","                                 s  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  "," s s        sssssssss    s ss  s  ss","r  rrrrrrrrr         rrrrrrr rr rr  ","                             r      "],b.actionTableNumber=[" 1 0        /.-,+*)('    & %$  #  \"!","                 J                  ","a  aaaaaaaaa         aaaaaaa aa  a  ","                YYYYY               "," 1 0        /.-,+*)('    & %$  #  \"!","K1  KKKKKKKK .  +*)('KKKKKK  KK# K\" "," 1 0        /.-,+*)('    & %$  #  \"!","                            N       ","                            O       ","e  eeeeeeeee         eeeeeee ee ee  ","f  fffffffff         fffffff ff ff  ","d  ddddddddd         ddddddd dd dd  ","B  BBBBBBBBB         BBBBBBB BB BB  ","A  AAAAAAAAA         AAAAAAA AA AA  ","  P                                 ","                            Q       "," 1           .  +*)('          #  \" ","b  bbbbbbbbb         bbbbbbb bb  b  ","                                    ","!       S                    !!  !  ",'"      T"                    ""  "  ',"$   V  $$            U       $$  $  ","&   &ZY&&            &XW     &&  &  ",")   )))))            )))\\[   ))  )  ",".   ....._^]         .....   ..  .  ","1   11111111         11111   11  1  ","5   55555555         55555`  55  5  ","7   77777777         777777  77  7  ","9   99999999         999999  99  9  ",":  c::::::::         ::::::b :: a:  ","I  fIIIIIIII         IIIIIIe II  I  ","=  =========         ======= == ==  ","?  ?????????         ??????? ?? ??  ","C  CCCCCCCCC         CCCCCCC CC CC  ","J   JJJJJJJJ         JJJJJJ  JJ  J  ","M   MMMMMMMM         MMMMMM  MM  M  ","N  NNNNNNNNN         NNNNNNN NN  N  ","P  PPPPPPPPP         PPPPPPP PP  P  ","                +*)('               ","R  RRRRRRRRR         RRRRRRR RR aR  ","U  UUUUUUUUU         UUUUUUU UU  U  ","Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  ","c  ccccccccc         ccccccc cc cc  ","                             j      ","L  fLLLLLLLL         LLLLLLe LL  L  ","6   66666666         66666   66  6  ","              k                     ","                             l      ","                XXXXX               "," 1 0        /.-,+*)('    & %$m #  \"!","_  f________         ______e __  _  "," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('      %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ",">  >>>>>>>>>         >>>>>>> >> >>  "," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ","Q  QQQQQQQQQ         QQQQQQQ QQ aQ  ","V  VVVVVVVVV         VVVVVVV VV aV  ","T  TTTTTTTTT         TTTTTTT TT  T  ","@  @@@@@@@@@         @@@@@@@ @@ @@  ","                                   ","[  [[[[[[[[[         [[[[[[[ [[ [[  ","D  DDDDDDDDD         DDDDDDD DD DD  ","                             HH     ","                                   ","                             F     ","#      T#                    ##  #  ","%   V  %%            U       %%  %  ","'   'ZY''            'XW     ''  '  ","(   (ZY((            (XW     ((  (  ","+   +++++            +++\\[   ++  +  ","*   *****            ***\\[   **  *  ","-   -----            ---\\[   --  -  ",",   ,,,,,            ,,,\\[   ,,  ,  ","0   00000_^]         00000   00  0  ","/   /////_^]         /////   //  /  ","2   22222222         22222   22  2  ","3   33333333         33333   33  3  ","4   44444444         44444   44  4  ","8   88888888         888888  88  8  ","                                 ^  ","                                   ",";  f;;;;;;;;         ;;;;;;e ;;  ;  ","<  f<<<<<<<<         <<<<<<e <<  <  ","O  OOOOOOOOO         OOOOOOO OO  O  ","`  `````````         ``````` ``  `  ","S  SSSSSSSSS         SSSSSSS SS  S  ","W  WWWWWWWWW         WWWWWWW WW  W  ","\\  \\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\ \\\\ \\\\  ","E  EEEEEEEEE         EEEEEEE EE EE  "," 1 0        /.-,+*)('    & %$  #  \"!","]  ]]]]]]]]]         ]]]]]]] ]] ]]  ","                             G      "],b.gotoTable=["3456789:;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","L456789:;<=>?@ AB  CDEFGH IJ ","            M        EFGH IJ ","       N;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","            S        EFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              e              ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                        h  J ","              i          j   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABpqCDEFGH IJ ","                             ","  r6789:;<=>?@ AB  CDEFGH IJ ","   s789:;<=>?@ AB  CDEFGH IJ ","    t89:;<=>?@ AB  CDEFGH IJ ","    u89:;<=>?@ AB  CDEFGH IJ ","     v9:;<=>?@ AB  CDEFGH IJ ","     w9:;<=>?@ AB  CDEFGH IJ ","     x9:;<=>?@ AB  CDEFGH IJ ","     y9:;<=>?@ AB  CDEFGH IJ ","      z:;<=>?@ AB  CDEFGH IJ ","      {:;<=>?@ AB  CDEFGH IJ ","       |;<=>?@ AB  CDEFGH IJ ","       };<=>?@ AB  CDEFGH IJ ","       ~;<=>?@ AB  CDEFGH IJ ","         =>?@ AB  CDEFGH IJ ","456789:;<=>?@ AB  CDEFGH IJ","                    EFGH IJ ","                    EFGH IJ ","                             ","                      GH IJ ","                      GH IJ ","              i             ","              i             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABqCDEFGH IJ ","                             ","                             "],b.productions=[[1,1,2],[2,1,3],[3,1,4],[3,3,3,-9,4],[4,1,5],[4,3,4,-8,5],[5,1,6],[5,3,5,-22,6],[5,3,5,-5,6],[6,1,7],[6,3,6,-23,7],[6,3,6,-24,7],[6,3,6,-6,7],[6,3,6,-7,7],[7,1,8],[7,3,7,-25,8],[7,3,7,-26,8],[8,1,9],[8,3,8,-12,9],[8,3,8,-11,9],[8,3,8,-10,9],[9,1,10],[9,2,-26,9],[10,1,11],[10,3,10,-27,11],[11,1,12],[11,1,13],[11,3,13,-28,14],[11,3,13,-4,14],[13,1,15],[13,2,13,16],[15,1,17],[15,3,-29,2,-30],[15,1,-15],[15,1,-16],[15,1,18],[18,3,-13,-29,-30],[18,4,-13,-29,19,-30],[19,1,20],[19,3,20,-31,19],[20,1,2],[12,1,14],[12,1,21],[21,1,-28],[21,2,-28,14],[21,1,22],[14,1,23],[14,3,14,-28,23],[14,1,24],[23,2,25,26],[23,1,26],[23,3,25,26,27],[23,2,26,27],[23,1,28],[27,1,16],[27,2,16,27],[25,2,-14,-3],[25,1,-32],[26,1,29],[26,3,-20,-29,-30],[26,4,-21,-29,-15,-30],[16,3,-33,30,-34],[30,1,2],[22,2,-4,14],[24,3,14,-4,23],[28,1,-35],[28,1,-2],[17,2,-36,-18],[29,1,-17],[29,1,-19],[29,1,-18]],b.DOUBLEDOT=2,b.DOUBLECOLON=3,b.DOUBLESLASH=4,b.NOTEQUAL=5,b.LESSTHANOREQUAL=6,b.GREATERTHANOREQUAL=7,b.AND=8,b.OR=9,b.MOD=10,b.DIV=11,b.MULTIPLYOPERATOR=12,b.FUNCTIONNAME=13,b.AXISNAME=14,b.LITERAL=15,b.NUMBER=16,b.ASTERISKNAMETEST=17,b.QNAME=18,b.NCNAMECOLONASTERISK=19,b.NODETYPE=20,b.PROCESSINGINSTRUCTIONWITHLITERAL=21,b.EQUALS=22,b.LESSTHAN=23,b.GREATERTHAN=24,b.PLUS=25,b.MINUS=26,b.BAR=27,b.SLASH=28,b.LEFTPARENTHESIS=29,b.RIGHTPARENTHESIS=30,b.COMMA=31,b.AT=32,b.LEFTBRACKET=33,b.RIGHTBRACKET=34,b.DOT=35,b.DOLLAR=36,b.prototype.tokenize=function(a){for(var c=[],d=[],e=a+"\x00",f=0,g=e.charAt(f++);;){for(;" "==g||"	"==g||"\r"==g||"\n"==g;)g=e.charAt(f++);if("\x00"==g||f>=e.length)break;if("("!=g)if(")"!=g)if("["!=g)if("]"!=g)if("@"!=g)if(","!=g)if("|"!=g)if("+"!=g)if("-"!=g)if("="!=g)if("$"!=g)if("."!=g)if("'"!=g&&'"'!=g)if(g>="0"&&"9">=g){var h=g;for(g=e.charAt(f++);g>="0"&&"9">=g;)h+=g,g=e.charAt(f++);if("."==g&&e.charAt(f)>="0"&&e.charAt(f)<="9")for(h+=g,h+=e.charAt(f++),g=e.charAt(f++);g>="0"&&"9">=g;)h+=g,g=e.charAt(f++);c.push(b.NUMBER),d.push(h)}else if("*"!=g)if(":"!=g||":"!=e.charAt(f))if("/"!=g)if("!"!=g||"="!=e.charAt(f))if("<"!=g)if(">"!=g){if("_"!=g&&!Utilities.isLetter(g.charCodeAt(0)))throw new Error("Unexpected character "+g);var i=g;for(g=e.charAt(f++);Utilities.isNCNameChar(g.charCodeAt(0));)i+=g,g=e.charAt(f++);if(c.length>0){var j=c[c.length-1];if(j!=b.AT&&j!=b.DOUBLECOLON&&j!=b.LEFTPARENTHESIS&&j!=b.LEFTBRACKET&&j!=b.AND&&j!=b.OR&&j!=b.MOD&&j!=b.DIV&&j!=b.MULTIPLYOPERATOR&&j!=b.SLASH&&j!=b.DOUBLESLASH&&j!=b.BAR&&j!=b.PLUS&&j!=b.MINUS&&j!=b.EQUALS&&j!=b.NOTEQUAL&&j!=b.LESSTHAN&&j!=b.LESSTHANOREQUAL&&j!=b.GREATERTHAN&&j!=b.GREATERTHANOREQUAL){if("and"==i){c.push(b.AND),d.push(i);continue}if("or"==i){c.push(b.OR),d.push(i);continue}if("mod"==i){c.push(b.MOD),d.push(i);continue}if("div"==i){c.push(b.DIV),d.push(i);continue}}}if(":"==g){if("*"==e.charAt(f)){c.push(b.NCNAMECOLONASTERISK),d.push(i+":*"),f++,g=e.charAt(f++);continue}if("_"==e.charAt(f)||Utilities.isLetter(e.charCodeAt(f))){for(i+=":",g=e.charAt(f++);Utilities.isNCNameChar(g.charCodeAt(0));)i+=g,g=e.charAt(f++);if("("==g){c.push(b.FUNCTIONNAME),d.push(i);continue}c.push(b.QNAME),d.push(i);continue}if(":"==e.charAt(f)){c.push(b.AXISNAME),d.push(i);continue}}if("("==g){if("comment"==i||"text"==i||"node"==i){c.push(b.NODETYPE),d.push(i);continue}if("processing-instruction"==i){c.push(")"==e.charAt(f)?b.NODETYPE:b.PROCESSINGINSTRUCTIONWITHLITERAL),d.push(i);continue}c.push(b.FUNCTIONNAME),d.push(i);continue}c.push(b.QNAME),d.push(i)}else{if("="==e.charAt(f)){c.push(b.GREATERTHANOREQUAL),d.push(">="),f++,g=e.charAt(f++);continue}c.push(b.GREATERTHAN),d.push(">"),g=e.charAt(f++)}else{if("="==e.charAt(f)){c.push(b.LESSTHANOREQUAL),d.push("<="),f++,g=e.charAt(f++);continue}c.push(b.LESSTHAN),d.push("<"),g=e.charAt(f++)}else c.push(b.NOTEQUAL),d.push("!="),f++,g=e.charAt(f++);else{if(g=e.charAt(f++),"/"==g){c.push(b.DOUBLESLASH),d.push("//"),g=e.charAt(f++);continue}c.push(b.SLASH),d.push("/")}else c.push(b.DOUBLECOLON),d.push("::"),f++,g=e.charAt(f++);else{if(c.length>0){var j=c[c.length-1];if(j!=b.AT&&j!=b.DOUBLECOLON&&j!=b.LEFTPARENTHESIS&&j!=b.LEFTBRACKET&&j!=b.AND&&j!=b.OR&&j!=b.MOD&&j!=b.DIV&&j!=b.MULTIPLYOPERATOR&&j!=b.SLASH&&j!=b.DOUBLESLASH&&j!=b.BAR&&j!=b.PLUS&&j!=b.MINUS&&j!=b.EQUALS&&j!=b.NOTEQUAL&&j!=b.LESSTHAN&&j!=b.LESSTHANOREQUAL&&j!=b.GREATERTHAN&&j!=b.GREATERTHANOREQUAL){c.push(b.MULTIPLYOPERATOR),d.push(g),g=e.charAt(f++);continue}}c.push(b.ASTERISKNAMETEST),d.push(g),g=e.charAt(f++)}else{for(var k=g,l="";(g=e.charAt(f++))!=k;)l+=g;c.push(b.LITERAL),d.push(l),g=e.charAt(f++)}else{if(g=e.charAt(f++),"."==g){c.push(b.DOUBLEDOT),d.push(".."),g=e.charAt(f++);continue}if(g>="0"&&"9">=g){var h="."+g;for(g=e.charAt(f++);g>="0"&&"9">=g;)h+=g,g=e.charAt(f++);c.push(b.NUMBER),d.push(h);continue}c.push(b.DOT),d.push(".")}else c.push(b.DOLLAR),d.push(g),g=e.charAt(f++);else c.push(b.EQUALS),d.push(g),g=e.charAt(f++);else c.push(b.MINUS),d.push(g),g=e.charAt(f++);else c.push(b.PLUS),d.push(g),g=e.charAt(f++);else c.push(b.BAR),d.push(g),g=e.charAt(f++);else c.push(b.COMMA),d.push(g),g=e.charAt(f++);else c.push(b.AT),d.push(g),g=e.charAt(f++);else c.push(b.RIGHTBRACKET),d.push(g),g=e.charAt(f++);else c.push(b.LEFTBRACKET),d.push(g),g=e.charAt(f++);else c.push(b.RIGHTPARENTHESIS),d.push(g),g=e.charAt(f++);else c.push(b.LEFTPARENTHESIS),d.push(g),g=e.charAt(f++)}return c.push(1),d.push("[EOF]"),[c,d]},b.SHIFT="s",b.REDUCE="r",b.ACCEPT="a",b.prototype.parse=function(a){var d,e,f=this.tokenize(a);if(void 0==f)return void 0;d=f[0],e=f[1];var a,g,h,i=0,j=[],k=[],l=[];for(j.push(0),k.push(1),l.push("_S"),g=d[i],h=e[i++];;)switch(a=j[j.length-1],b.actionTable[a].charAt(g-1)){case b.SHIFT:k.push(-g),l.push(h),j.push(b.actionTableNumber[a].charCodeAt(g-1)-32),g=d[i],h=e[i++];break;case b.REDUCE:for(var m=b.productions[b.actionTableNumber[a].charCodeAt(g-1)-32][1],n=[],o=0;m>o;o++)k.pop(),n.unshift(l.pop()),j.pop();var p=j[j.length-1];k.push(b.productions[b.actionTableNumber[a].charCodeAt(g-1)-32][0]),l.push(void 0==this.reduceActions[b.actionTableNumber[a].charCodeAt(g-1)-32]?n[0]:this.reduceActions[b.actionTableNumber[a].charCodeAt(g-1)-32](n)),j.push(b.gotoTable[p].charCodeAt(b.productions[b.actionTableNumber[a].charCodeAt(g-1)-32][0]-2)-33);break;case b.ACCEPT:return new c(l.pop());default:throw new Error("XPath parse error")}},c.prototype=new Object,c.prototype.constructor=c,c.superclass=Object.prototype,c.prototype.toString=function(){return this.expression.toString()},c.prototype.evaluate=function(a){if(a.contextNode=a.expressionContextNode,a.contextSize=1,a.contextPosition=1,a.caseInsensitive=!1,null!=a.contextNode){var b=a.contextNode;9!=b.nodeType&&(b=b.ownerDocument);try{a.caseInsensitive=b.implementation.hasFeature("HTML","2.0")}catch(c){a.caseInsensitive=!0}}return this.expression.evaluate(a)},c.XML_NAMESPACE_URI="http://www.w3.org/XML/1998/namespace",c.XMLNS_NAMESPACE_URI="http://www.w3.org/2000/xmlns/",d.prototype=new Object,d.prototype.constructor=d,d.superclass=Object.prototype,d.prototype.init=function(){},d.prototype.toString=function(){return"<Expression>"},d.prototype.evaluate=function(){throw new Error("Could not evaluate expression.")},e.prototype=new d,e.prototype.constructor=e,e.superclass=d.prototype,e.prototype.init=function(a){this.rhs=a},f.prototype=new e,f.prototype.constructor=f,f.superclass=e.prototype,f.prototype.init=function(a){f.superclass.init.call(this,a)},f.prototype.evaluate=function(a){return this.rhs.evaluate(a).number().negate()},f.prototype.toString=function(){return"-"+this.rhs.toString()},g.prototype=new d,g.prototype.constructor=g,g.superclass=d.prototype,g.prototype.init=function(a,b){this.lhs=a,this.rhs=b},h.prototype=new g,h.prototype.constructor=h,h.superclass=g.prototype,h.prototype.init=function(a,b){h.superclass.init.call(this,a,b)},h.prototype.toString=function(){return"("+this.lhs.toString()+" or "+this.rhs.toString()+")"},h.prototype.evaluate=function(a){var b=this.lhs.evaluate(a).bool();return b.booleanValue()?b:this.rhs.evaluate(a).bool()},i.prototype=new g,i.prototype.constructor=i,i.superclass=g.prototype,i.prototype.init=function(a,b){i.superclass.init.call(this,a,b)},i.prototype.toString=function(){return"("+this.lhs.toString()+" and "+this.rhs.toString()+")"},i.prototype.evaluate=function(a){var b=this.lhs.evaluate(a).bool();return b.booleanValue()?this.rhs.evaluate(a).bool():b},j.prototype=new g,j.prototype.constructor=j,j.superclass=g.prototype,j.prototype.init=function(a,b){j.superclass.init.call(this,a,b)},j.prototype.toString=function(){return"("+this.lhs.toString()+" = "+this.rhs.toString()+")"},j.prototype.evaluate=function(a){return this.lhs.evaluate(a).equals(this.rhs.evaluate(a))},k.prototype=new g,k.prototype.constructor=k,k.superclass=g.prototype,k.prototype.init=function(a,b){k.superclass.init.call(this,a,b)},k.prototype.toString=function(){return"("+this.lhs.toString()+" != "+this.rhs.toString()+")"},k.prototype.evaluate=function(a){return this.lhs.evaluate(a).notequal(this.rhs.evaluate(a))},l.prototype=new g,l.prototype.constructor=l,l.superclass=g.prototype,l.prototype.init=function(a,b){l.superclass.init.call(this,a,b)},l.prototype.evaluate=function(a){return this.lhs.evaluate(a).lessthan(this.rhs.evaluate(a))},l.prototype.toString=function(){return"("+this.lhs.toString()+" < "+this.rhs.toString()+")"},m.prototype=new g,m.prototype.constructor=m,m.superclass=g.prototype,m.prototype.init=function(a,b){m.superclass.init.call(this,a,b)},m.prototype.evaluate=function(a){return this.lhs.evaluate(a).greaterthan(this.rhs.evaluate(a))},m.prototype.toString=function(){return"("+this.lhs.toString()+" > "+this.rhs.toString()+")"},n.prototype=new g,n.prototype.constructor=n,n.superclass=g.prototype,n.prototype.init=function(a,b){n.superclass.init.call(this,a,b)},n.prototype.evaluate=function(a){return this.lhs.evaluate(a).lessthanorequal(this.rhs.evaluate(a))},n.prototype.toString=function(){return"("+this.lhs.toString()+" <= "+this.rhs.toString()+")"},o.prototype=new g,o.prototype.constructor=o,o.superclass=g.prototype,o.prototype.init=function(a,b){o.superclass.init.call(this,a,b)},o.prototype.evaluate=function(a){return this.lhs.evaluate(a).greaterthanorequal(this.rhs.evaluate(a))},o.prototype.toString=function(){return"("+this.lhs.toString()+" >= "+this.rhs.toString()+")"},p.prototype=new g,p.prototype.constructor=p,p.superclass=g.prototype,p.prototype.init=function(a,b){p.superclass.init.call(this,a,b)},p.prototype.evaluate=function(a){return this.lhs.evaluate(a).number().plus(this.rhs.evaluate(a).number())},p.prototype.toString=function(){return"("+this.lhs.toString()+" + "+this.rhs.toString()+")"},q.prototype=new g,q.prototype.constructor=q,q.superclass=g.prototype,q.prototype.init=function(a,b){q.superclass.init.call(this,a,b)},q.prototype.evaluate=function(a){return this.lhs.evaluate(a).number().minus(this.rhs.evaluate(a).number())},q.prototype.toString=function(){return"("+this.lhs.toString()+" - "+this.rhs.toString()+")"},r.prototype=new g,r.prototype.constructor=r,r.superclass=g.prototype,r.prototype.init=function(a,b){r.superclass.init.call(this,a,b)},r.prototype.evaluate=function(a){return this.lhs.evaluate(a).number().multiply(this.rhs.evaluate(a).number())},r.prototype.toString=function(){return"("+this.lhs.toString()+" * "+this.rhs.toString()+")"},s.prototype=new g,s.prototype.constructor=s,s.superclass=g.prototype,s.prototype.init=function(a,b){s.superclass.init.call(this,a,b)},s.prototype.evaluate=function(a){return this.lhs.evaluate(a).number().div(this.rhs.evaluate(a).number())},s.prototype.toString=function(){return"("+this.lhs.toString()+" div "+this.rhs.toString()+")"},t.prototype=new g,t.prototype.constructor=t,t.superclass=g.prototype,t.prototype.init=function(a,b){t.superclass.init.call(this,a,b)},t.prototype.evaluate=function(a){return this.lhs.evaluate(a).number().mod(this.rhs.evaluate(a).number())},t.prototype.toString=function(){return"("+this.lhs.toString()+" mod "+this.rhs.toString()+")"},u.prototype=new g,u.prototype.constructor=u,u.superclass=g.prototype,u.prototype.init=function(a,b){u.superclass.init.call(this,a,b)},u.prototype.evaluate=function(a){return this.lhs.evaluate(a).nodeset().union(this.rhs.evaluate(a).nodeset())},u.prototype.toString=function(){return this.lhs.toString()+" | "+this.rhs.toString()},v.prototype=new d,v.prototype.constructor=v,v.superclass=d.prototype,v.prototype.init=function(a,b,c){v.superclass.init.call(this),this.filter=a,this.filterPredicates=b,this.locationPath=c
},v.prototype.evaluate=function(a){var b,d=new H;if(d.variableResolver=a.variableResolver,d.functionResolver=a.functionResolver,d.namespaceResolver=a.namespaceResolver,d.expressionContextNode=a.expressionContextNode,d.virtualRoot=a.virtualRoot,d.caseInsensitive=a.caseInsensitive,null==this.filter)b=[a.contextNode];else{var e=this.filter.evaluate(a);if(!Utilities.instance_of(e,F)){if(null!=this.filterPredicates&&this.filterPredicates.length>0||null!=this.locationPath)throw new Error("Path expression filter must evaluate to a nodset if predicates or location path are used");return e}if(b=e.toArray(),null!=this.filterPredicates)for(var f=0;f<this.filterPredicates.length;f++){var g=this.filterPredicates[f],h=[];for(d.contextSize=b.length,d.contextPosition=1;d.contextPosition<=d.contextSize;d.contextPosition++)d.contextNode=b[d.contextPosition-1],this.predicateMatches(g,d)&&h.push(d.contextNode);b=h}}if(null!=this.locationPath){if(this.locationPath.absolute)if(9!=b[0].nodeType)if(null!=d.virtualRoot)b=[d.virtualRoot];else if(null==b[0].ownerDocument){for(var i=b[0];null!=i.parentNode;)i=i.parentNode;b=[i]}else b=[b[0].ownerDocument];else b=[b[0]];for(var j=0;j<this.locationPath.steps.length;j++){for(var k=this.locationPath.steps[j],h=[],f=0;f<b.length;f++)switch(d.contextNode=b[f],k.axis){case x.ANCESTOR:if(d.contextNode===d.virtualRoot)break;var l;for(l=2==d.contextNode.nodeType?this.getOwnerElement(d.contextNode):d.contextNode.parentNode;null!=l&&(k.nodeTest.matches(l,d)&&h.push(l),l!==d.virtualRoot);)l=l.parentNode;break;case x.ANCESTORORSELF:for(var l=d.contextNode;null!=l&&(k.nodeTest.matches(l,d)&&h.push(l),l!==d.virtualRoot);l=2==l.nodeType?this.getOwnerElement(l):l.parentNode);break;case x.ATTRIBUTE:var m=d.contextNode.attributes;if(null!=m)for(var n=0;n<m.length;n++){var l=m.item(n);k.nodeTest.matches(l,d)&&h.push(l)}break;case x.CHILD:for(var l=d.contextNode.firstChild;null!=l;l=l.nextSibling)k.nodeTest.matches(l,d)&&h.push(l);break;case x.DESCENDANT:for(var o=[d.contextNode.firstChild];o.length>0;)for(var l=o.pop();null!=l;)k.nodeTest.matches(l,d)&&h.push(l),null!=l.firstChild?(o.push(l.nextSibling),l=l.firstChild):l=l.nextSibling;break;case x.DESCENDANTORSELF:k.nodeTest.matches(d.contextNode,d)&&h.push(d.contextNode);for(var o=[d.contextNode.firstChild];o.length>0;)for(var l=o.pop();null!=l;)k.nodeTest.matches(l,d)&&h.push(l),null!=l.firstChild?(o.push(l.nextSibling),l=l.firstChild):l=l.nextSibling;break;case x.FOLLOWING:if(d.contextNode===d.virtualRoot)break;var o=[];o.unshift(null!=d.contextNode.firstChild?d.contextNode.firstChild:d.contextNode.nextSibling);for(var l=d.contextNode.parentNode;null!=l&&9!=l.nodeType&&l!==d.virtualRoot;l=l.parentNode)o.unshift(l.nextSibling);do for(var l=o.pop();null!=l;)k.nodeTest.matches(l,d)&&h.push(l),null!=l.firstChild?(o.push(l.nextSibling),l=l.firstChild):l=l.nextSibling;while(o.length>0);break;case x.FOLLOWINGSIBLING:if(d.contextNode===d.virtualRoot)break;for(var l=d.contextNode.nextSibling;null!=l;l=l.nextSibling)k.nodeTest.matches(l,d)&&h.push(l);break;case x.NAMESPACE:var i={};if(1==d.contextNode.nodeType){i.xml=c.XML_NAMESPACE_URI,i.xmlns=c.XMLNS_NAMESPACE_URI;for(var l=d.contextNode;null!=l&&1==l.nodeType;l=l.parentNode)for(var n=0;n<l.attributes.length;n++){var p=l.attributes.item(n),q=String(p.name);if("xmlns"==q)void 0==i[""]&&(i[""]=p.value);else if(q.length>6&&"xmlns:"==q.substring(0,6)){var r=q.substring(6,q.length);void 0==i[r]&&(i[r]=p.value)}}for(var r in i){var s=new NamespaceNode(r,i[r],d.contextNode);k.nodeTest.matches(s,d)&&h.push(s)}}break;case x.PARENT:l=null,d.contextNode!==d.virtualRoot&&(l=2==d.contextNode.nodeType?this.getOwnerElement(d.contextNode):d.contextNode.parentNode),null!=l&&k.nodeTest.matches(l,d)&&h.push(l);break;case x.PRECEDING:var o;o=null!=d.virtualRoot?[d.virtualRoot]:9==d.contextNode.nodeType?[d.contextNode]:[d.contextNode.ownerDocument];a:for(;o.length>0;)for(var l=o.pop();null!=l;){if(l==d.contextNode)break a;k.nodeTest.matches(l,d)&&h.unshift(l),null!=l.firstChild?(o.push(l.nextSibling),l=l.firstChild):l=l.nextSibling}break;case x.PRECEDINGSIBLING:if(d.contextNode===d.virtualRoot)break;for(var l=d.contextNode.previousSibling;null!=l;l=l.previousSibling)k.nodeTest.matches(l,d)&&h.push(l);break;case x.SELF:k.nodeTest.matches(d.contextNode,d)&&h.push(d.contextNode)}b=h;for(var f=0;f<k.predicates.length;f++){var g=k.predicates[f],h=[];for(d.contextSize=b.length,d.contextPosition=1;d.contextPosition<=d.contextSize;d.contextPosition++)d.contextNode=b[d.contextPosition-1],this.predicateMatches(g,d)&&h.push(d.contextNode);b=h}}}var e=new F;return e.addArray(b),e},v.prototype.predicateMatches=function(a,b){var c=a.evaluate(b);return Utilities.instance_of(c,C)?b.contextPosition==c.numberValue():c.booleanValue()},v.prototype.toString=function(){if(void 0!=this.filter){var a=this.filter.toString();if(Utilities.instance_of(this.filter,B)&&(a="'"+a+"'"),void 0!=this.filterPredicates)for(var b=0;b<this.filterPredicates.length;b++)a=a+"["+this.filterPredicates[b].toString()+"]";return void 0!=this.locationPath&&(this.locationPath.absolute||(a+="/"),a+=this.locationPath.toString()),a}return this.locationPath.toString()},v.prototype.getOwnerElement=function(a){if(a.ownerElement)return a.ownerElement;try{if(a.selectSingleNode)return a.selectSingleNode("..")}catch(b){}for(var c=9==a.nodeType?a:a.ownerDocument,d=c.getElementsByTagName("*"),e=0;e<d.length;e++)for(var f=d.item(e),g=f.attributes,h=0;h<g.length;h++){var i=g.item(h);if(i===a)return f}return null},w.prototype=new Object,w.prototype.constructor=w,w.superclass=Object.prototype,w.prototype.init=function(a,b){this.absolute=a,this.steps=b},w.prototype.toString=function(){var a;a=this.absolute?"/":"";for(var b=0;b<this.steps.length;b++)0!=b&&(a+="/"),a+=this.steps[b].toString();return a},x.prototype=new Object,x.prototype.constructor=x,x.superclass=Object.prototype,x.prototype.init=function(a,b,c){this.axis=a,this.nodeTest=b,this.predicates=c},x.prototype.toString=function(){var a;switch(this.axis){case x.ANCESTOR:a="ancestor";break;case x.ANCESTORORSELF:a="ancestor-or-self";break;case x.ATTRIBUTE:a="attribute";break;case x.CHILD:a="child";break;case x.DESCENDANT:a="descendant";break;case x.DESCENDANTORSELF:a="descendant-or-self";break;case x.FOLLOWING:a="following";break;case x.FOLLOWINGSIBLING:a="following-sibling";break;case x.NAMESPACE:a="namespace";break;case x.PARENT:a="parent";break;case x.PRECEDING:a="preceding";break;case x.PRECEDINGSIBLING:a="preceding-sibling";break;case x.SELF:a="self"}a+="::",a+=this.nodeTest.toString();for(var b=0;b<this.predicates.length;b++)a+="["+this.predicates[b].toString()+"]";return a},x.ANCESTOR=0,x.ANCESTORORSELF=1,x.ATTRIBUTE=2,x.CHILD=3,x.DESCENDANT=4,x.DESCENDANTORSELF=5,x.FOLLOWING=6,x.FOLLOWINGSIBLING=7,x.NAMESPACE=8,x.PARENT=9,x.PRECEDING=10,x.PRECEDINGSIBLING=11,x.SELF=12,y.prototype=new Object,y.prototype.constructor=y,y.superclass=Object.prototype,y.prototype.init=function(a,b){this.type=a,this.value=b},y.prototype.toString=function(){switch(this.type){case y.NAMETESTANY:return"*";case y.NAMETESTPREFIXANY:return this.value+":*";case y.NAMETESTRESOLVEDANY:return"{"+this.value+"}*";case y.NAMETESTQNAME:return this.value;case y.NAMETESTRESOLVEDNAME:return"{"+this.namespaceURI+"}"+this.value;case y.COMMENT:return"comment()";case y.TEXT:return"text()";case y.PI:return void 0!=this.value?'processing-instruction("'+this.value+'")':"processing-instruction()";case y.NODE:return"node()"}return"<unknown nodetest type>"},y.prototype.matches=function(a,b){switch(this.type){case y.NAMETESTANY:return 2==a.nodeType||1==a.nodeType||a.nodeType==G.XPATH_NAMESPACE_NODE?!0:!1;case y.NAMETESTPREFIXANY:if(2==a.nodeType||1==a.nodeType){var c=b.namespaceResolver.getNamespace(this.value,b.expressionContextNode);if(null==c)throw new Error("Cannot resolve QName "+this.value);return c==(a.namespaceURI||"")}return!1;case y.NAMETESTQNAME:if(2==a.nodeType||1==a.nodeType||a.nodeType==G.XPATH_NAMESPACE_NODE){var d=Utilities.resolveQName(this.value,b.namespaceResolver,b.expressionContextNode,!1);if(null==d[0])throw new Error("Cannot resolve QName "+this.value);d[0]=String(d[0]),d[1]=String(d[1]),""==d[0]&&(d[0]=null);var e=[a.namespaceURI||"",a.localName];return e[0]=String(e[0]),e[1]=String(e[1]),""==e[0]&&(e[0]=null),b.caseInsensitive?d[0]==e[0]&&String(d[1]).toLowerCase()==String(e[1]).toLowerCase():d[0]==e[0]&&d[1]==e[1]}return!1;case y.COMMENT:return 8==a.nodeType;case y.TEXT:return 3==a.nodeType||4==a.nodeType;case y.PI:return 7==a.nodeType&&(null==this.value||a.nodeName==this.value);case y.NODE:return 9==a.nodeType||1==a.nodeType||2==a.nodeType||3==a.nodeType||4==a.nodeType||8==a.nodeType||7==a.nodeType}return!1},y.NAMETESTANY=0,y.NAMETESTPREFIXANY=1,y.NAMETESTQNAME=2,y.COMMENT=3,y.TEXT=4,y.PI=5,y.NODE=6,z.prototype=new d,z.prototype.constructor=z,z.superclass=d.prototype,z.prototype.init=function(a){this.variable=a},z.prototype.toString=function(){return"$"+this.variable},z.prototype.evaluate=function(a){return a.variableResolver.getVariable(this.variable,a)},A.prototype=new d,A.prototype.constructor=A,A.superclass=d.prototype,A.prototype.init=function(a,b){this.functionName=a,this.arguments=b},A.prototype.toString=function(){for(var a=this.functionName+"(",b=0;b<this.arguments.length;b++)b>0&&(a+=", "),a+=this.arguments[b].toString();return a+")"},A.prototype.evaluate=function(a){var b=a.functionResolver.getFunction(this.functionName,a);if(void 0==b)throw new Error("Unknown function "+this.functionName);var c=[a].concat(this.arguments);return b.apply(a.functionResolver.thisArg,c)},B.prototype=new d,B.prototype.constructor=B,B.superclass=d.prototype,B.prototype.init=function(a){this.str=a},B.prototype.toString=function(){return this.str},B.prototype.evaluate=function(){return this},B.prototype.string=function(){return this},B.prototype.number=function(){return new C(this.str)},B.prototype.bool=function(){return new D(this.str)},B.prototype.nodeset=function(){throw new Error("Cannot convert string to nodeset")},B.prototype.stringValue=function(){return this.str},B.prototype.numberValue=function(){return this.number().numberValue()},B.prototype.booleanValue=function(){return this.bool().booleanValue()},B.prototype.equals=function(a){return Utilities.instance_of(a,D)?this.bool().equals(a):Utilities.instance_of(a,C)?this.number().equals(a):Utilities.instance_of(a,F)?a.compareWithString(this,R.equals):new D(this.str==a.str)},B.prototype.notequal=function(a){return Utilities.instance_of(a,D)?this.bool().notequal(a):Utilities.instance_of(a,C)?this.number().notequal(a):Utilities.instance_of(a,F)?a.compareWithString(this,R.notequal):new D(this.str!=a.str)},B.prototype.lessthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.greaterthanorequal):this.number().lessthan(a.number())},B.prototype.greaterthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.lessthanorequal):this.number().greaterthan(a.number())},B.prototype.lessthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.greaterthan):this.number().lessthanorequal(a.number())},B.prototype.greaterthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.lessthan):this.number().greaterthanorequal(a.number())},C.prototype=new d,C.prototype.constructor=C,C.superclass=d.prototype,C.prototype.init=function(a){this.num=Number(a)},C.prototype.toString=function(){return this.num},C.prototype.evaluate=function(){return this},C.prototype.string=function(){return new B(this.num)},C.prototype.number=function(){return this},C.prototype.bool=function(){return new D(this.num)},C.prototype.nodeset=function(){throw new Error("Cannot convert number to nodeset")},C.prototype.stringValue=function(){return this.string().stringValue()},C.prototype.numberValue=function(){return this.num},C.prototype.booleanValue=function(){return this.bool().booleanValue()},C.prototype.negate=function(){return new C(-this.num)},C.prototype.equals=function(a){return Utilities.instance_of(a,D)?this.bool().equals(a):Utilities.instance_of(a,B)?this.equals(a.number()):Utilities.instance_of(a,F)?a.compareWithNumber(this,R.equals):new D(this.num==a.num)},C.prototype.notequal=function(a){return Utilities.instance_of(a,D)?this.bool().notequal(a):Utilities.instance_of(a,B)?this.notequal(a.number()):Utilities.instance_of(a,F)?a.compareWithNumber(this,R.notequal):new D(this.num!=a.num)},C.prototype.lessthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this,R.greaterthanorequal):Utilities.instance_of(a,D)||Utilities.instance_of(a,B)?this.lessthan(a.number()):new D(this.num<a.num)},C.prototype.greaterthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this,R.lessthanorequal):Utilities.instance_of(a,D)||Utilities.instance_of(a,B)?this.greaterthan(a.number()):new D(this.num>a.num)},C.prototype.lessthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this,R.greaterthan):Utilities.instance_of(a,D)||Utilities.instance_of(a,B)?this.lessthanorequal(a.number()):new D(this.num<=a.num)},C.prototype.greaterthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this,R.lessthan):Utilities.instance_of(a,D)||Utilities.instance_of(a,B)?this.greaterthanorequal(a.number()):new D(this.num>=a.num)},C.prototype.plus=function(a){return new C(this.num+a.num)},C.prototype.minus=function(a){return new C(this.num-a.num)},C.prototype.multiply=function(a){return new C(this.num*a.num)},C.prototype.div=function(a){return new C(this.num/a.num)},C.prototype.mod=function(a){return new C(this.num%a.num)},D.prototype=new d,D.prototype.constructor=D,D.superclass=d.prototype,D.prototype.init=function(a){this.b=Boolean(a)},D.prototype.toString=function(){return this.b.toString()},D.prototype.evaluate=function(){return this},D.prototype.string=function(){return new B(this.b)},D.prototype.number=function(){return new C(this.b)},D.prototype.bool=function(){return this},D.prototype.nodeset=function(){throw new Error("Cannot convert boolean to nodeset")},D.prototype.stringValue=function(){return this.string().stringValue()},D.prototype.numberValue=function(){return this.num().numberValue()},D.prototype.booleanValue=function(){return this.b},D.prototype.not=function(){return new D(!this.b)},D.prototype.equals=function(a){return Utilities.instance_of(a,B)||Utilities.instance_of(a,C)?this.equals(a.bool()):Utilities.instance_of(a,F)?a.compareWithBoolean(this,R.equals):new D(this.b==a.b)},D.prototype.notequal=function(a){return Utilities.instance_of(a,B)||Utilities.instance_of(a,C)?this.notequal(a.bool()):Utilities.instance_of(a,F)?a.compareWithBoolean(this,R.notequal):new D(this.b!=a.b)},D.prototype.lessthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.greaterthanorequal):this.number().lessthan(a.number())},D.prototype.greaterthan=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.lessthanorequal):this.number().greaterthan(a.number())},D.prototype.lessthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.greaterthan):this.number().lessthanorequal(a.number())},D.prototype.greaterthanorequal=function(a){return Utilities.instance_of(a,F)?a.compareWithNumber(this.number(),R.lessthan):this.number().greaterthanorequal(a.number())},E.prototype=new Object,E.prototype.constructor=E,E.superclass=Object.prototype,E.prototype.init=function(a){this.left=null,this.right=null,this.node=a,this.depth=1},E.prototype.balance=function(){var a=null==this.left?0:this.left.depth,b=null==this.right?0:this.right.depth;if(a>b+1){var c=null==this.left.left?0:this.left.left.depth,d=null==this.left.right?0:this.left.right.depth;d>c&&this.left.rotateRR(),this.rotateLL()}else if(b>a+1){var e=null==this.right.right?0:this.right.right.depth,f=null==this.right.left?0:this.right.left.depth;f>e&&this.right.rotateLL(),this.rotateRR()}},E.prototype.rotateLL=function(){var a=this.node,b=this.right;this.node=this.left.node,this.right=this.left,this.left=this.left.left,this.right.left=this.right.right,this.right.right=b,this.right.node=a,this.right.updateInNewLocation(),this.updateInNewLocation()},E.prototype.rotateRR=function(){var a=this.node,b=this.left;this.node=this.right.node,this.left=this.right,this.right=this.right.right,this.left.right=this.left.left,this.left.left=b,this.left.node=a,this.left.updateInNewLocation(),this.updateInNewLocation()},E.prototype.updateInNewLocation=function(){this.getDepthFromChildren()},E.prototype.getDepthFromChildren=function(){this.depth=null==this.node?0:1,null!=this.left&&(this.depth=this.left.depth+1),null!=this.right&&this.depth<=this.right.depth&&(this.depth=this.right.depth+1)},E.prototype.order=function(a,b){if(a===b)return 0;for(var c=0,d=0,e=a;null!=e;e=e.parentNode)c++;for(var f=b;null!=f;f=f.parentNode)d++;if(c>d){for(;c>d;)a=a.parentNode,c--;if(a==b)return 1}else if(d>c){for(;d>c;)b=b.parentNode,d--;if(a==b)return-1}for(;a.parentNode!=b.parentNode;)a=a.parentNode,b=b.parentNode;for(;null!=a.previousSibling&&null!=b.previousSibling;)a=a.previousSibling,b=b.previousSibling;return null==a.previousSibling?-1:1},E.prototype.add=function(a){if(a===this.node)return!1;var b=this.order(a,this.node),c=!1;return-1==b?null==this.left?(this.left=new E(a),c=!0):(c=this.left.add(a),c&&this.balance()):1==b&&(null==this.right?(this.right=new E(a),c=!0):(c=this.right.add(a),c&&this.balance())),c&&this.getDepthFromChildren(),c},F.prototype=new d,F.prototype.constructor=F,F.superclass=d.prototype,F.prototype.init=function(){this.tree=null,this.size=0},F.prototype.toString=function(){var a=this.first();return null==a?"":this.stringForNode(a)},F.prototype.evaluate=function(){return this},F.prototype.string=function(){return new B(this.toString())},F.prototype.stringValue=function(){return this.toString()},F.prototype.number=function(){return new C(this.string())},F.prototype.numberValue=function(){return Number(this.string())},F.prototype.bool=function(){return new D(null!=this.tree)},F.prototype.booleanValue=function(){return null!=this.tree},F.prototype.nodeset=function(){return this},F.prototype.stringForNode=function(a){return 9==a.nodeType&&(a=a.documentElement),1==a.nodeType?this.stringForNodeRec(a):a.isNamespaceNode?a.namespace:a.nodeValue},F.prototype.stringForNodeRec=function(a){for(var b="",c=a.firstChild;null!=c;c=c.nextSibling)3==c.nodeType?b+=c.nodeValue:1==c.nodeType&&(b+=this.stringForNodeRec(c));return b},F.prototype.first=function(){var a=this.tree;if(null==a)return null;for(;null!=a.left;)a=a.left;return a.node},F.prototype.add=function(a){var b;null==this.tree?(this.tree=new E(a),b=!0):b=this.tree.add(a),b&&this.size++},F.prototype.addArray=function(a){for(var b=0;b<a.length;b++)this.add(a[b])},F.prototype.toArray=function(){var a=[];return this.toArrayRec(this.tree,a),a},F.prototype.toArrayRec=function(a,b){null!=a&&(this.toArrayRec(a.left,b),b.push(a.node),this.toArrayRec(a.right,b))},F.prototype.compareWithString=function(a,b){for(var c=this.toArray(),d=0;d<c.length;d++){var e=c[d],f=new B(this.stringForNode(e)),g=b(f,a);if(g.booleanValue())return g}return new D(!1)},F.prototype.compareWithNumber=function(a,b){for(var c=this.toArray(),d=0;d<c.length;d++){var e=c[d],f=new C(this.stringForNode(e)),g=b(f,a);if(g.booleanValue())return g}return new D(!1)},F.prototype.compareWithBoolean=function(a,b){return b(this.bool(),a)},F.prototype.compareWithNodeSet=function(a,b){for(var c=this.toArray(),d=0;d<c.length;d++)for(var e=c[d],f=new B(this.stringForNode(e)),g=a.toArray(),h=0;h<g.length;h++){var i=g[h],a=new B(this.stringForNode(i)),j=b(f,a);if(j.booleanValue())return j}return new D(!1)},F.prototype.equals=function(a){return Utilities.instance_of(a,B)?this.compareWithString(a,R.equals):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.equals):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.equals):this.compareWithNodeSet(a,R.equals)},F.prototype.notequal=function(a){return Utilities.instance_of(a,B)?this.compareWithString(a,R.notequal):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.notequal):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.notequal):this.compareWithNodeSet(a,R.notequal)},F.prototype.lessthan=function(a){return Utilities.instance_of(a,B)?this.compareWithNumber(a.number(),R.lessthan):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.lessthan):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.lessthan):this.compareWithNodeSet(a,R.lessthan)},F.prototype.greaterthan=function(a){return Utilities.instance_of(a,B)?this.compareWithNumber(a.number(),R.greaterthan):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.greaterthan):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.greaterthan):this.compareWithNodeSet(a,R.greaterthan)},F.prototype.lessthanorequal=function(a){return Utilities.instance_of(a,B)?this.compareWithNumber(a.number(),R.lessthanorequal):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.lessthanorequal):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.lessthanorequal):this.compareWithNodeSet(a,R.lessthanorequal)},F.prototype.greaterthanorequal=function(a){return Utilities.instance_of(a,B)?this.compareWithNumber(a.number(),R.greaterthanorequal):Utilities.instance_of(a,C)?this.compareWithNumber(a,R.greaterthanorequal):Utilities.instance_of(a,D)?this.compareWithBoolean(a,R.greaterthanorequal):this.compareWithNodeSet(a,R.greaterthanorequal)},F.prototype.union=function(a){var b=new F;return b.tree=this.tree,b.size=this.size,b.addArray(a.toArray()),b},G.prototype=new Object,G.prototype.constructor=G,G.superclass=Object.prototype,G.prototype.toString=function(){return'{ "'+this.prefix+'", "'+this.namespaceURI+'" }'};var R=new Object;R.equals=function(a,b){return a.equals(b)},R.notequal=function(a,b){return a.notequal(b)},R.lessthan=function(a,b){return a.lessthan(b)},R.greaterthan=function(a,b){return a.greaterthan(b)},R.lessthanorequal=function(a,b){return a.lessthanorequal(b)},R.greaterthanorequal=function(a,b){return a.greaterthanorequal(b)},H.prototype=new Object,H.prototype.constructor=H,H.superclass=Object.prototype,I.prototype=new Object,I.prototype.constructor=I,I.superclass=Object.prototype,I.prototype.getVariable=function(a,b){var c=Utilities.splitQName(a);if(null!=c[0]&&(c[0]=b.namespaceResolver.getNamespace(c[0],b.expressionContextNode),null==c[0]))throw new Error("Cannot resolve QName "+fn);return this.getVariableWithName(c[0],c[1],b.expressionContextNode)},I.prototype.getVariableWithName=function(){return null},J.prototype=new Object,J.prototype.constructor=J,J.superclass=Object.prototype,J.prototype.addStandardFunctions=function(){this.functions["{}last"]=Functions.last,this.functions["{}position"]=Functions.position,this.functions["{}count"]=Functions.count,this.functions["{}id"]=Functions.id,this.functions["{}local-name"]=Functions.localName,this.functions["{}namespace-uri"]=Functions.namespaceURI,this.functions["{}name"]=Functions.name,this.functions["{}string"]=Functions.string,this.functions["{}concat"]=Functions.concat,this.functions["{}starts-with"]=Functions.startsWith,this.functions["{}contains"]=Functions.contains,this.functions["{}substring-before"]=Functions.substringBefore,this.functions["{}substring-after"]=Functions.substringAfter,this.functions["{}substring"]=Functions.substring,this.functions["{}string-length"]=Functions.stringLength,this.functions["{}normalize-space"]=Functions.normalizeSpace,this.functions["{}translate"]=Functions.translate,this.functions["{}boolean"]=Functions.boolean_,this.functions["{}not"]=Functions.not,this.functions["{}true"]=Functions.true_,this.functions["{}false"]=Functions.false_,this.functions["{}lang"]=Functions.lang,this.functions["{}number"]=Functions.number,this.functions["{}sum"]=Functions.sum,this.functions["{}floor"]=Functions.floor,this.functions["{}ceiling"]=Functions.ceiling,this.functions["{}round"]=Functions.round},J.prototype.addFunction=function(a,b,c){this.functions["{"+a+"}"+b]=c},J.prototype.getFunction=function(a,b){var c=Utilities.resolveQName(a,b.namespaceResolver,b.contextNode,!1);if(null==c[0])throw new Error("Cannot resolve QName "+a);return this.getFunctionWithName(c[0],c[1],b.contextNode)},J.prototype.getFunctionWithName=function(a,b){return this.functions["{"+a+"}"+b]},K.prototype=new Object,K.prototype.constructor=K,K.superclass=Object.prototype,K.prototype.getNamespace=function(a,b){if("xml"==a)return c.XML_NAMESPACE_URI;if("xmlns"==a)return c.XMLNS_NAMESPACE_URI;for(9==b.nodeType?b=b.documentElement:2==b.nodeType?b=v.prototype.getOwnerElement(b):1!=b.nodeType&&(b=b.parentNode);null!=b&&1==b.nodeType;){for(var d=b.attributes,e=0;e<d.length;e++){var f=d.item(e),g=f.nodeName;if("xmlns"==g&&""==a||g=="xmlns:"+a)return String(f.nodeValue)}b=b.parentNode}return null},Functions=new Object,Functions.last=function(){var a=arguments[0];if(1!=arguments.length)throw new Error("Function last expects ()");return new C(a.contextSize)},Functions.position=function(){var a=arguments[0];if(1!=arguments.length)throw new Error("Function position expects ()");return new C(a.contextPosition)},Functions.count=function(){var a,b=arguments[0];if(2!=arguments.length||!Utilities.instance_of(a=arguments[1].evaluate(b),F))throw new Error("Function count expects (node-set)");return new C(a.size)},Functions.id=function(){var a,b=arguments[0];if(2!=arguments.length)throw new Error("Function id expects (object)");a=arguments[1].evaluate(b),a=Utilities.instance_of(a,F)?a.toArray().join(" "):a.stringValue();for(var c=a.split(/[\x0d\x0a\x09\x20]+/),d=0,e=new F,f=9==b.contextNode.nodeType?b.contextNode:b.contextNode.ownerDocument,g=0;g<c.length;g++){var h;h=f.getElementById?f.getElementById(c[g]):Utilities.getElementById(f,c[g]),null!=h&&(e.add(h),d++)}return e},Functions.localName=function(){var a,b=arguments[0];if(1==arguments.length)a=b.contextNode;else{if(2!=arguments.length)throw new Error("Function local-name expects (node-set?)");a=arguments[1].evaluate(b).first()}return new B(null==a?"":a.localName?a.localName:a.baseName)},Functions.namespaceURI=function(){var a,b=arguments[0];if(1==arguments.length)a=b.contextNode;else{if(2!=arguments.length)throw new Error("Function namespace-uri expects (node-set?)");a=arguments[1].evaluate(b).first()}return new B(null==a?"":a.namespaceURI)},Functions.name=function(){var a,b=arguments[0];if(1==arguments.length)a=b.contextNode;else{if(2!=arguments.length)throw new Error("Function name expects (node-set?)");a=arguments[1].evaluate(b).first()}return new B(null==a?"":1==a.nodeType||2==a.nodeType?a.nodeName:null==a.localName?"":a.localName)},Functions.string=function(){var a=arguments[0];if(1==arguments.length)return F.prototype.stringForNode(a.contextNode);if(2==arguments.length)return arguments[1].evaluate(a).string();throw new Error("Function string expects (object?)")},Functions.concat=function(){var a=arguments[0];if(arguments.length<3)throw new Error("Function concat expects (string, string, string*)");for(var b="",c=1;c<arguments.length;c++)b+=arguments[c].evaluate(a).stringValue();return new B(b)},Functions.startsWith=function(){var a=arguments[0];if(3!=arguments.length)throw new Error("Function startsWith expects (string, string)");var b=arguments[1].evaluate(a).stringValue(),c=arguments[2].evaluate(a).stringValue();return new D(b.substring(0,c.length)==c)},Functions.contains=function(){var a=arguments[0];if(3!=arguments.length)throw new Error("Function contains expects (string, string)");var b=arguments[1].evaluate(a).stringValue(),c=arguments[2].evaluate(a).stringValue();return new D(-1!=b.indexOf(c))},Functions.substringBefore=function(){var a=arguments[0];if(3!=arguments.length)throw new Error("Function substring-before expects (string, string)");var b=arguments[1].evaluate(a).stringValue(),c=arguments[2].evaluate(a).stringValue();return new B(b.substring(0,b.indexOf(c)))},Functions.substringAfter=function(){var a=arguments[0];if(3!=arguments.length)throw new Error("Function substring-after expects (string, string)");var b=arguments[1].evaluate(a).stringValue(),c=arguments[2].evaluate(a).stringValue();if(0==c.length)return new B(b);var d=b.indexOf(c);return new B(-1==d?"":b.substring(b.indexOf(c)+1))},Functions.substring=function(){var a=arguments[0];if(3!=arguments.length&&4!=arguments.length)throw new Error("Function substring expects (string, number, number?)");var b=arguments[1].evaluate(a).stringValue(),c=Math.round(arguments[2].evaluate(a).numberValue())-1,d=4==arguments.length?c+Math.round(arguments[3].evaluate(a).numberValue()):void 0;return new B(b.substring(c,d))},Functions.stringLength=function(){var a,b=arguments[0];if(1==arguments.length)a=F.prototype.stringForNode(b.contextNode);else{if(2!=arguments.length)throw new Error("Function string-length expects (string?)");a=arguments[1].evaluate(b).stringValue()}return new C(a.length)},Functions.normalizeSpace=function(){var a,b=arguments[0];if(1==arguments.length)a=F.prototype.stringForNode(b.contextNode);else{if(2!=arguments.length)throw new Error("Function normalize-space expects (string?)");a=arguments[1].evaluate(b).stringValue()}for(var c=0,d=a.length-1;Utilities.isSpace(a.charCodeAt(d));)d--;for(var e="";d>=c&&Utilities.isSpace(a.charCodeAt(c));)c++;for(;d>=c;)if(Utilities.isSpace(a.charCodeAt(c)))for(e+=" ";d>=c&&Utilities.isSpace(a.charCodeAt(c));)c++;else e+=a.charAt(c),c++;return new B(e)},Functions.translate=function(){var a=arguments[0];if(4!=arguments.length)throw new Error("Function translate expects (string, string, string)");for(var b=arguments[1].evaluate(a).stringValue(),c=arguments[2].evaluate(a).stringValue(),d=arguments[3].evaluate(a).stringValue(),e=[],f=0;f<c.length;f++){var g=c.charCodeAt(f);if(void 0==e[g]){var h=f>d.length?"":d.charAt(f);e[g]=h}}for(var i="",f=0;f<b.length;f++){var a=b.charCodeAt(f),j=e[a];i+=void 0==j?b.charAt(f):j}return new B(i)},Functions.boolean_=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function boolean expects (object)");return arguments[1].evaluate(a).bool()},Functions.not=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function not expects (object)");return arguments[1].evaluate(a).bool().not()},Functions.true_=function(){if(1!=arguments.length)throw new Error("Function true expects ()");return new D(!0)},Functions.false_=function(){if(1!=arguments.length)throw new Error("Function false expects ()");return new D(!1)},Functions.lang=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function lang expects (string)");for(var b,d=a.contextNode;null!=d&&9!=d.nodeType;d=d.parentNode){var e=d.getAttributeNS(c.XML_NAMESPACE_URI,"lang");if(null!=e){b=String(e);break}}if(null==b)return new D(!1);var f=arguments[1].evaluate(a).stringValue();return new D(b.substring(0,f.length)==f&&(b.length==f.length||"-"==b.charAt(f.length)))},Functions.number=function(){var a=arguments[0];if(1!=arguments.length&&2!=arguments.length)throw new Error("Function number expects (object?)");return 1==arguments.length?new C(F.prototype.stringForNode(a.contextNode)):arguments[1].evaluate(a).number()},Functions.sum=function(){var a,b=arguments[0];if(2!=arguments.length||!Utilities.instance_of(a=arguments[1].evaluate(b),F))throw new Error("Function sum expects (node-set)");a=a.toArray();for(var c=0,d=0;d<a.length;d++)c+=new C(F.prototype.stringForNode(a[d])).numberValue();return new C(c)},Functions.floor=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function floor expects (number)");return new C(Math.floor(arguments[1].evaluate(a).numberValue()))},Functions.ceiling=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function ceiling expects (number)");return new C(Math.ceil(arguments[1].evaluate(a).numberValue()))},Functions.round=function(){var a=arguments[0];if(2!=arguments.length)throw new Error("Function round expects (number)");
return new C(Math.round(arguments[1].evaluate(a).numberValue()))},Utilities=new Object,Utilities.splitQName=function(a){var b=a.indexOf(":");return-1==b?[null,a]:[a.substring(0,b),a.substring(b+1)]},Utilities.resolveQName=function(a,b,c,d){var e=Utilities.splitQName(a);return null!=e[0]?e[0]=b.getNamespace(e[0],c):d?(e[0]=b.getNamespace("",c),null==e[0]&&(e[0]="")):e[0]="",e},Utilities.isSpace=function(a){return 9==a||13==a||10==a||32==a},Utilities.isLetter=function(a){return a>=65&&90>=a||a>=97&&122>=a||a>=192&&214>=a||a>=216&&246>=a||a>=248&&255>=a||a>=256&&305>=a||a>=308&&318>=a||a>=321&&328>=a||a>=330&&382>=a||a>=384&&451>=a||a>=461&&496>=a||a>=500&&501>=a||a>=506&&535>=a||a>=592&&680>=a||a>=699&&705>=a||902==a||a>=904&&906>=a||908==a||a>=910&&929>=a||a>=931&&974>=a||a>=976&&982>=a||986==a||988==a||990==a||992==a||a>=994&&1011>=a||a>=1025&&1036>=a||a>=1038&&1103>=a||a>=1105&&1116>=a||a>=1118&&1153>=a||a>=1168&&1220>=a||a>=1223&&1224>=a||a>=1227&&1228>=a||a>=1232&&1259>=a||a>=1262&&1269>=a||a>=1272&&1273>=a||a>=1329&&1366>=a||1369==a||a>=1377&&1414>=a||a>=1488&&1514>=a||a>=1520&&1522>=a||a>=1569&&1594>=a||a>=1601&&1610>=a||a>=1649&&1719>=a||a>=1722&&1726>=a||a>=1728&&1742>=a||a>=1744&&1747>=a||1749==a||a>=1765&&1766>=a||a>=2309&&2361>=a||2365==a||a>=2392&&2401>=a||a>=2437&&2444>=a||a>=2447&&2448>=a||a>=2451&&2472>=a||a>=2474&&2480>=a||2482==a||a>=2486&&2489>=a||a>=2524&&2525>=a||a>=2527&&2529>=a||a>=2544&&2545>=a||a>=2565&&2570>=a||a>=2575&&2576>=a||a>=2579&&2600>=a||a>=2602&&2608>=a||a>=2610&&2611>=a||a>=2613&&2614>=a||a>=2616&&2617>=a||a>=2649&&2652>=a||2654==a||a>=2674&&2676>=a||a>=2693&&2699>=a||2701==a||a>=2703&&2705>=a||a>=2707&&2728>=a||a>=2730&&2736>=a||a>=2738&&2739>=a||a>=2741&&2745>=a||2749==a||2784==a||a>=2821&&2828>=a||a>=2831&&2832>=a||a>=2835&&2856>=a||a>=2858&&2864>=a||a>=2866&&2867>=a||a>=2870&&2873>=a||2877==a||a>=2908&&2909>=a||a>=2911&&2913>=a||a>=2949&&2954>=a||a>=2958&&2960>=a||a>=2962&&2965>=a||a>=2969&&2970>=a||2972==a||a>=2974&&2975>=a||a>=2979&&2980>=a||a>=2984&&2986>=a||a>=2990&&2997>=a||a>=2999&&3001>=a||a>=3077&&3084>=a||a>=3086&&3088>=a||a>=3090&&3112>=a||a>=3114&&3123>=a||a>=3125&&3129>=a||a>=3168&&3169>=a||a>=3205&&3212>=a||a>=3214&&3216>=a||a>=3218&&3240>=a||a>=3242&&3251>=a||a>=3253&&3257>=a||3294==a||a>=3296&&3297>=a||a>=3333&&3340>=a||a>=3342&&3344>=a||a>=3346&&3368>=a||a>=3370&&3385>=a||a>=3424&&3425>=a||a>=3585&&3630>=a||3632==a||a>=3634&&3635>=a||a>=3648&&3653>=a||a>=3713&&3714>=a||3716==a||a>=3719&&3720>=a||3722==a||3725==a||a>=3732&&3735>=a||a>=3737&&3743>=a||a>=3745&&3747>=a||3749==a||3751==a||a>=3754&&3755>=a||a>=3757&&3758>=a||3760==a||a>=3762&&3763>=a||3773==a||a>=3776&&3780>=a||a>=3904&&3911>=a||a>=3913&&3945>=a||a>=4256&&4293>=a||a>=4304&&4342>=a||4352==a||a>=4354&&4355>=a||a>=4357&&4359>=a||4361==a||a>=4363&&4364>=a||a>=4366&&4370>=a||4412==a||4414==a||4416==a||4428==a||4430==a||4432==a||a>=4436&&4437>=a||4441==a||a>=4447&&4449>=a||4451==a||4453==a||4455==a||4457==a||a>=4461&&4462>=a||a>=4466&&4467>=a||4469==a||4510==a||4520==a||4523==a||a>=4526&&4527>=a||a>=4535&&4536>=a||4538==a||a>=4540&&4546>=a||4587==a||4592==a||4601==a||a>=7680&&7835>=a||a>=7840&&7929>=a||a>=7936&&7957>=a||a>=7960&&7965>=a||a>=7968&&8005>=a||a>=8008&&8013>=a||a>=8016&&8023>=a||8025==a||8027==a||8029==a||a>=8031&&8061>=a||a>=8064&&8116>=a||a>=8118&&8124>=a||8126==a||a>=8130&&8132>=a||a>=8134&&8140>=a||a>=8144&&8147>=a||a>=8150&&8155>=a||a>=8160&&8172>=a||a>=8178&&8180>=a||a>=8182&&8188>=a||8486==a||a>=8490&&8491>=a||8494==a||a>=8576&&8578>=a||a>=12353&&12436>=a||a>=12449&&12538>=a||a>=12549&&12588>=a||a>=44032&&55203>=a||a>=19968&&40869>=a||12295==a||a>=12321&&12329>=a},Utilities.isNCNameChar=function(a){return a>=48&&57>=a||a>=1632&&1641>=a||a>=1776&&1785>=a||a>=2406&&2415>=a||a>=2534&&2543>=a||a>=2662&&2671>=a||a>=2790&&2799>=a||a>=2918&&2927>=a||a>=3047&&3055>=a||a>=3174&&3183>=a||a>=3302&&3311>=a||a>=3430&&3439>=a||a>=3664&&3673>=a||a>=3792&&3801>=a||a>=3872&&3881>=a||46==a||45==a||95==a||Utilities.isLetter(a)||a>=768&&837>=a||a>=864&&865>=a||a>=1155&&1158>=a||a>=1425&&1441>=a||a>=1443&&1465>=a||a>=1467&&1469>=a||1471==a||a>=1473&&1474>=a||1476==a||a>=1611&&1618>=a||1648==a||a>=1750&&1756>=a||a>=1757&&1759>=a||a>=1760&&1764>=a||a>=1767&&1768>=a||a>=1770&&1773>=a||a>=2305&&2307>=a||2364==a||a>=2366&&2380>=a||2381==a||a>=2385&&2388>=a||a>=2402&&2403>=a||a>=2433&&2435>=a||2492==a||2494==a||2495==a||a>=2496&&2500>=a||a>=2503&&2504>=a||a>=2507&&2509>=a||2519==a||a>=2530&&2531>=a||2562==a||2620==a||2622==a||2623==a||a>=2624&&2626>=a||a>=2631&&2632>=a||a>=2635&&2637>=a||a>=2672&&2673>=a||a>=2689&&2691>=a||2748==a||a>=2750&&2757>=a||a>=2759&&2761>=a||a>=2763&&2765>=a||a>=2817&&2819>=a||2876==a||a>=2878&&2883>=a||a>=2887&&2888>=a||a>=2891&&2893>=a||a>=2902&&2903>=a||a>=2946&&2947>=a||a>=3006&&3010>=a||a>=3014&&3016>=a||a>=3018&&3021>=a||3031==a||a>=3073&&3075>=a||a>=3134&&3140>=a||a>=3142&&3144>=a||a>=3146&&3149>=a||a>=3157&&3158>=a||a>=3202&&3203>=a||a>=3262&&3268>=a||a>=3270&&3272>=a||a>=3274&&3277>=a||a>=3285&&3286>=a||a>=3330&&3331>=a||a>=3390&&3395>=a||a>=3398&&3400>=a||a>=3402&&3405>=a||3415==a||3633==a||a>=3636&&3642>=a||a>=3655&&3662>=a||3761==a||a>=3764&&3769>=a||a>=3771&&3772>=a||a>=3784&&3789>=a||a>=3864&&3865>=a||3893==a||3895==a||3897==a||3902==a||3903==a||a>=3953&&3972>=a||a>=3974&&3979>=a||a>=3984&&3989>=a||3991==a||a>=3993&&4013>=a||a>=4017&&4023>=a||4025==a||a>=8400&&8412>=a||8417==a||a>=12330&&12335>=a||12441==a||12442==a||183==a||720==a||721==a||903==a||1600==a||3654==a||3782==a||12293==a||a>=12337&&12341>=a||a>=12445&&12446>=a||a>=12540&&12542>=a},Utilities.coalesceText=function(a){for(var b=a.firstChild;null!=b;b=b.nextSibling)if(3==b.nodeType||4==b.nodeType){var c=b.nodeValue,d=b;for(b=b.nextSibling;null!=b&&(3==b.nodeType||4==b.nodeType);){c+=b.nodeValue;var e=b;b=b.nextSibling,e.parentNode.removeChild(e)}if(4==d.nodeType){var f=d.parentNode;if(null==d.nextSibling)f.removeChild(d),f.appendChild(f.ownerDocument.createTextNode(c));else{var g=d.nextSibling;f.removeChild(d),f.insertBefore(f.ownerDocument.createTextNode(c),g)}}else d.nodeValue=c;if(null==b)break}else 1==b.nodeType&&Utilities.coalesceText(b)},Utilities.instance_of=function(a,b){for(;null!=a;){if(a.constructor===b)return!0;if(a===Object)return!1;a=a.constructor.superclass}return!1},Utilities.getElementById=function(a,b){if(1==a.nodeType&&(a.getAttribute("id")==b||a.getAttributeNS(null,"id")==b))return a;for(var c=a.firstChild;null!=c;c=c.nextSibling){var d=Utilities.getElementById(c,b);if(null!=d)return d}return null},L.prototype={},L.prototype.constructor=L,L.superclass=Object.prototype,L.prototype.toString=function(){var a=this.exception?": "+this.exception.toString():"";switch(this.code){case L.INVALID_EXPRESSION_ERR:return"Invalid expression"+a;case L.TYPE_ERR:return"Type error"+a}},L.INVALID_EXPRESSION_ERR=51,L.TYPE_ERR=52,M.prototype={},M.prototype.constructor=M,M.superclass=Object.prototype,M.prototype.evaluate=function(a,b){this.context.expressionContextNode=a;var c=this.xpath.evaluate(this.context);return new P(c,b)},N.prototype={},N.prototype.constructor=N,N.superclass=Object.prototype,N.prototype.getNamespace=function(a){return null==this.xpathNSResolver?null:this.xpathNSResolver.lookupNamespaceURI(a)},O.prototype={},O.prototype.constructor=O,O.superclass=Object.prototype,O.prototype.lookupNamespaceURI=function(a){return this.namespaceResolver.getNamespace(a,this.node)},P.prototype={},P.prototype.constructor=P,P.superclass=Object.prototype,P.prototype.iterateNext=function(){if(this.resultType!=P.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=P.ORDERED_NODE_ITERATOR_TYPE)throw new L(L.TYPE_ERR);return this.nodes[this.iteratorIndex++]},P.prototype.snapshotItem=function(a){if(this.resultType!=P.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=P.ORDERED_NODE_SNAPSHOT_TYPE)throw new L(L.TYPE_ERR);return this.nodes[a]},P.ANY_TYPE=0,P.NUMBER_TYPE=1,P.STRING_TYPE=2,P.BOOLEAN_TYPE=3,P.UNORDERED_NODE_ITERATOR_TYPE=4,P.ORDERED_NODE_ITERATOR_TYPE=5,P.UNORDERED_NODE_SNAPSHOT_TYPE=6,P.ORDERED_NODE_SNAPSHOT_TYPE=7,P.ANY_UNORDERED_NODE_TYPE=8,P.FIRST_ORDERED_NODE_TYPE=9;try{var S=!0;try{document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("XPath",null)&&(S=!1)}catch(T){}S&&Q(document,new b)}catch(T){}Q(a,new b),a.XPathResult=P,a.select=function(b,c,d){return a.selectWithResolver(b,c,null,d)},a.useNamespaces=function(b){var c={mappings:b||{},lookupNamespaceURI:function(a){return this.mappings[a]}};return function(b,d,e){return a.selectWithResolver(b,d,c,e)}},a.selectWithResolver=function(a,c,d,e){var f=new M(a,d,new b),g=P.ANY_TYPE,h=f.evaluate(c,g,null);return h.resultType==P.STRING_TYPE?h=h.stringValue:h.resultType==P.NUMBER_TYPE?h=h.numberValue:h.resultType==P.BOOLEAN_TYPE?h=h.booleanValue:(h=h.nodes,e&&(h=h[0])),h},a.select1=function(b,c){return a.select(b,c,!0)}}("undefined"!=typeof exports?exports:xpath);